!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.MeetBridge=t()}(this,function(){"use strict";return function(){function e(e,t){void 0===e&&(e="meetone://"),void 0===t&&(t="2.2.0"),this.tryTimes=0,this.scheme=e,this.version=t}return e.coverObjectToParams=function(e){try{var t=JSON.stringify(e);return btoa(encodeURIComponent(t))}catch(e){console.error(e)}return""},e.prototype._getCallbackId=function(){var e=parseInt(1e4*Math.random()+"");return"3_meet_callback_"+(new Date).getTime()+e},e.prototype._sendRequest=function(e){var t=this;try{window.postMessage(e),this.tryTimes=0}catch(o){this.tryTimes<60?setTimeout(function(){t._sendRequest(e),t.tryTimes=++t.tryTimes},1e3):console.error("post url timeout(60 times):",e)}},e.prototype.customGenerate=function(t){var o=this._getCallbackId();t=Object.assign(t,{callbackId:o});var r=this.generateURI(t);return this.version>=e.V2_MIN_VERSION?(this._sendRequest(r),new Promise(function(e,t){window[o]=function(r){try{e(r)}catch(e){t(e)}finally{window[o]=null}}})):r},e.prototype.timesGenerate=function(e,t,o){e=Object.assign(e,{callbackId:t});var r=this.generateURI(e);return this._sendRequest(r),window[t]=o,r},e.revertParamsToObject=function(e){try{var t=atob(e),o=decodeURIComponent(t);return JSON.parse(o)}catch(e){console.error(e)}return{}},e.prototype.generateURI=function(t){var o=t.routeName,r=void 0===o?"":o,n=t.params,i=void 0===n?{}:n,a=t.callbackId,s=void 0===a?"":a,c="";return c=this.scheme.concat(r).concat("?params=").concat(e.coverObjectToParams(i)),s&&(c=c.concat("&callbackId="+s)),c},e.prototype.invokeGetNetwork=function(){return this.customGenerate({routeName:"eos/network"})},e.prototype.invokeShare=function(e){var t=e.shareType,o=void 0===t?1:t,r=e.title,n=void 0===r?"":r,i=e.description,a=void 0===i?"":i,s=e.imgUrl,c=void 0===s?"":s,u=e.options,p=void 0===u?{}:u;return this.customGenerate({routeName:"app/share",params:{shareType:o,imgUrl:c,title:n,description:a,options:p}})},e.prototype.invokeShareCode=function(e){var t=e.description,o=void 0===t?"":t,r=e.name,n=void 0===r?"":r,i=e.target,a=void 0===i?"":i,s=e.banner,c=void 0===s?"":s,u=e.icon,p=void 0===u?"":u;return this.customGenerate({routeName:"app/share",params:{shareType:5,description:o,options:{name:n,target:a,banner:c,icon:p}}})},e.prototype.invokeAuthorizeInWeb=function(){return this.customGenerate({routeName:"eos/authorizeInWeb"})},e.prototype.invokeTransfer=function(e){var t=e.to,o=void 0===t?"":t,r=e.amount,n=void 0===r?0:r,i=e.tokenName,a=void 0===i?"EOS":i,s=e.tokenContract,c=void 0===s?"eosio.token":s,u=e.tokenPrecision,p=void 0===u?4:u,d=e.memo,v=void 0===d?"":d,m=e.orderInfo,h=void 0===m?"":m;return this.customGenerate({routeName:"eos/transfer",params:{to:o,amount:n,tokenName:a,tokenContract:c,tokenPrecision:p,memo:v,orderInfo:h}})},e.prototype.invokeTransaction=function(e){var t=e.actions,o=void 0===t?[]:t,r=e.options,n=void 0===r?{broadcast:!0}:r,i=e.description,a=void 0===i?"":i;return this.customGenerate({routeName:"eos/transaction",params:{actions:o,options:n,description:a}})},e.prototype.invokeAccountInfo=function(e){var t=void 0===e?{}:e,o=t.chainId,r=void 0===o?"":o,n=t.dappName,i=void 0===n?"":n;return this.customGenerate({routeName:"eos/account_info",params:{chainId:r,dappName:i}})},e.prototype.invokeNavigate=function(e){var t=e.target,o=void 0===t?"":t,r=e.options,n=void 0===r?{}:r;return this.customGenerate({routeName:"app/navigate",params:{target:o,options:n}})},e.prototype.invokeWebview=function(e){var t=e.url,o=void 0===t?"":t,r=e.title,n=void 0===r?"":r;return this.customGenerate({routeName:"app/webview",params:{url:o,title:n}})},e.prototype.webviewRightMenu=function(e){var t=e.title,o=void 0===t?"":t,r=e.callback,n=void 0===r?function(){}:r;return window["3_meet_callback_webview_right_menu"]=null,this.timesGenerate({routeName:"app/webview/right_menu",params:{right:o}},"3_meet_callback_webview_right_menu",n)},e.prototype.invokeSignProvider=function(e){var t=e.buf,o=void 0===t?[""]:t,r=e.transaction,n=void 0===r?null:r;return this.customGenerate({routeName:"eos/sign_provider",params:{buf:o,transaction:n}})},e.prototype.invokeSignature=function(e){var t=e.data,o=void 0===t?"":t,r=e.whatfor,n=void 0===r?"":r,i=e.isHash,a=void 0!==i&&i,s=e.isArbitrary,c=void 0!==s&&s;return this.customGenerate({routeName:"eos/signature",params:{data:o,whatfor:n,isHash:a,isArbitrary:c}})},e.prototype.invokeBalance=function(e){var t=e.accountName,o=void 0===t?"":t,r=e.contract,n=void 0===r?"eosio.token":r,i=e.symbol,a=void 0===i?"EOS":i;return this.customGenerate({routeName:"eos/getBalance",params:{accountName:o,contract:n,symbol:a}})},e.V2_MIN_VERSION="2.0.0",e}()});
